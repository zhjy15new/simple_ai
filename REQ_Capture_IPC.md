# REQ-01: 需求范围定义

## 1. 功能边界

- **核心功能**: 本工具的核心功能是从指定的网络摄像头获取单帧静态图片。
- **协议支持**: 优先使用`RTSP`协议获取视频流并从中截取一帧。`ONVIF`和`HTTP`快照作为备选方案。
- **配置化**: 所有关键参数，如IP地址、认证信息、协议类型、图片保存路径等，都必须是可配置的。
- **输出**: 工具的输出是一张`JPEG`格式的图片文件。

### 明确排除的功能:
- 实时视频流播放或处理。
- 视频录制功能。
- 车牌识别或任何形式的图像内容分析。
- 摄像头的PTZ（云台）控制。
- 复杂的图形用户界面(GUI)，将以命令行工具的形式提供。

## 2. 输出指令格式

- **图片格式**: 统一为`JPEG (.jpg)`格式。
- **文件命名**: 采用 `{timestamp}_{camera_id}.jpg` 的格式，例如 `20250127153000_cam01.jpg`。
- **图片质量**: 图片的JPEG压缩质量应可配置，默认为`85%`。
- **分辨率**: 保持摄像机输出的原始分辨率，不进行缩放。

## 3. 数据记录需求

- **操作日志**: 记录每一次成功或失败的图片获取操作，包括时间戳、目标摄像头、执行结果和耗时。
- **错误日志**: 详细记录所有错误信息，包括网络连接异常、认证失败、协议错误、文件保存失败等，并附带堆栈跟踪信息。
- **图片元数据(EXIF)**: 在JPEG文件中嵌入基本的元数据，至少包括：
  - 拍摄时间 (DateTimeOriginal)
  - 摄像机标识 (Camera Model Name)

## 4. 协议优先级

1. **RTSP**: 默认和首选协议，通用性强，能获取高质量的视频流帧。
2. **ONVIF**: 作为备选方案，用于标准化地获取设备信息和快照URI。
3. **HTTP Snapshot**: 作为最后的备选，如果设备支持简单的HTTP GET请求获取图片。

## 5. 异常处理场景

必须明确处理以下异常情况：
- **网络异常**:
  - 目标IP不可达
  - 连接超时
  - DNS解析失败
- **认证失败**:
  - 用户名或密码错误
- **协议错误**:
  - RTSP/ONVIF/HTTP请求返回错误码
  - 视频流格式不正确或无法解码
- **文件系统错误**:
  - 指定的保存路径不存在
  - 写入权限不足
  - 磁盘空间已满
- **配置错误**:
  - 配置文件格式错误
  - 必需的配置项缺失
